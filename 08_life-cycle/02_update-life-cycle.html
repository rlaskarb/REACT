<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>타아아아임</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script> <!-- react cdn링크-->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> <!-- babel 링크크-->
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        /*
            컴포넌트의 업데이트 생명주기
            1. props 변경
            2. state 변경
            3. 부모 컴포넌트의 리렌더링
            4. forceUpdate (안씀)

            state 따라라 update 상황 
        */

        class Time extends React.Component{

            // 1. 생성자자
            constructor(props){
                super(props);

                console.log("생성자 두둥등장");

                this.state={
                    now : new Date().toLocaleTimeString()
                }
            }


            // 2. props 값을 state 로 변환
            static getDerivedStateFromProps(props , state){

                console.log("getDerivedStateFromProps 두둥등장");
                console.log("props !!!" , props);
                console.log("state !!!", state);

                return null ;
            }



            // 3. 컴포넌트가 리렌더링을 할 것인지 말지 정하는 메도스 (render() 함수 호출 유무 결정 )
            shouldComponentUpdate(props,state){

                /*
                    props , state 를 전달 받아 컴포넌트를 재구성할지 하지 않을지
                    여기서 결정할 수 있다.
                    주로 성능 최적화를 위해 많이 쓰이며, 
                    상황에 따라 리렌더링 방지용으로 사용된다.
                */

                console.log("shouldComponentUpdate 두둥등장!!");
                console.log("s !! props",props);
                console.log("s !! state",state);

                // 리턴값은 반드시 boolean 타입 !! false 이면 render() 를 호출하지 않는다!
                return true;
            }



            //4. render()

            render(){
                console.log("render 두둥등장!!!")

                return(
                    <>
                        <button
                            onClick={()=>this.setState({now:new Date().toLocaleTimeString()})}                        
                        > 현재 시간 확인 !</button>
                        <h1>{this.state.now}</h1>
                    </>
                );
            }


            // 5. 컴포넌트 변화에 실제 DOM에 반영하기 직전에 호출되는 메소드
            getSnapshotBeforeUpdate(props,state){
                /*
                render 에서 만들어진 결과물이 반영되기 전 호출 되며,
                해당 메소드의 반환 값은 componentDidUpdate 에서 전달 받을수 있다.
                업데이트 하기 직전의 값을 참고할 일이 있을때
                사용이 된다. ex)스크롤 바 위치
                */

                console.log("getSnapshotBeforeUpdate 두둥등장!!");

                return{ message : "스뇁촵 촵 촵 촵 "};
            }


            // 6. 컴포넌트 업데이트 작업이 끝난 후 호출되는 메소드!
            /*
                리렌더링 후 화면이 업데이트 끝나고 실행된다.
                컴포넌트가 Update 이전에 가지고 있던 props, state , 추가적인 값을 접근할수 있다.
            */
            componentDidUpdate(prevProps,prevState,snapshot){
                console.log("componentDidUpdate 두둥등장");
                console.log("snapshot 두둥등장",snapshot);
            }


        }

        ReactDOM.createRoot(document.getElementById('root')).render(<Time/>);
    </script>

</body>
</html>